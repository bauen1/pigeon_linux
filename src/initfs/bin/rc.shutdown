#!/bin/busybox ash

umask 022

case "$1" in
  reboot)
    ;;
  poweroff)
    ;;
  *)
      echo "Invalid action '$1' for rc.shutdown" 1>&2
      exit 1
    ;;
esac

/usr/bin/killall5 -s TERM
/bin/sleep 3 # you have 3 seconds to save your stuff
/usr/bin/killall5 -s KILL # 9 is coming after your processes now

/bin/umount -a
/bin/sync

case "$1" in
  reboot)
    /usr/bin/halt -r
    ;;
  poweroff)
    /usr/bin/halt -p
    ;;
esac
